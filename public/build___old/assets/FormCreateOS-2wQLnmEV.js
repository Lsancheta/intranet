import{g as T,r as F,b as n,o as r,a as o,i as u,z as c,u as a,F as g,j as v,t as w,v as C,h as L,A as P}from"./app-D91oiFWV.js";const R={class:"p-6 bg-white rounded-lg shadow-md w-full max-w-lg mx-auto md:w-[550px]"},z=["value"],G=["value"],N=["value"],J={__name:"FormCreateOS",props:{alojamentos:Array,prioridades:Array},emits:["saved"],setup(A,{emit:q}){const U=q,p=A,l=T({alojamento_id:"",bloco_id:"",quarto_id:"",titulo:"",descricao:"",prioridade_id:"",fotos:[]}),f=F([]),y=F([]);function V(){const s=p.alojamentos.find(e=>e.id==l.alojamento_id);f.value=s?s.blocos:[],y.value=[],l.bloco_id="",l.quarto_id=""}function k(){const s=f.value.find(e=>e.id==l.bloco_id);y.value=s?s.quartos:[],l.quarto_id=""}function B(){l.post(P("ordens.store"),{onSuccess:()=>U("saved")})}function D(s,e=.6,t=1280){return new Promise((b,m)=>{const x=new FileReader;x.onload=E=>{const d=new Image;d.src=E.target.result,d.onload=()=>{const i=document.createElement("canvas"),M=i.getContext("2d"),O=t/d.width;i.width=t,i.height=d.height*O,M.drawImage(d,0,0,i.width,i.height),i.toBlob(j=>{if(j){const I=new File([j],s.name,{type:"image/jpeg",lastModified:Date.now()});b(I)}else m(new Error("Falha ao comprimir"))},"image/jpeg",e)},d.onerror=()=>m("Erro ao carregar imagem")},x.onerror=()=>m("Erro ao ler arquivo"),x.readAsDataURL(s)})}async function S(s){const e=Array.from(s.target.files),t=[];for(const b of e){const m=await D(b,.6,1280);t.push(m)}l.fotos=t}return(s,e)=>(r(),n("div",R,[e[16]||(e[16]=o("h2",{class:"text-xl font-bold mb-4 text-gray-700 text-center md:text-left"}," Criar Ordem de Serviço ",-1)),o("form",{onSubmit:L(B,["prevent"]),class:"space-y-4"},[o("div",null,[e[6]||(e[6]=o("label",{class:"font-medium text-sm md:text-base"},"Condomínio",-1)),u(o("select",{class:"border p-2 rounded w-full text-sm md:text-base","onUpdate:modelValue":e[0]||(e[0]=t=>a(l).alojamento_id=t),onChange:V},[e[5]||(e[5]=o("option",{value:""},"Selecione...",-1)),(r(!0),n(g,null,v(p.alojamentos,t=>(r(),n("option",{key:t.id,value:t.id},w(t.nome),9,z))),128))],544),[[c,a(l).alojamento_id]])]),o("div",null,[e[8]||(e[8]=o("label",{class:"font-medium text-sm md:text-base"},"Setor",-1)),u(o("select",{class:"border p-2 rounded w-full text-sm md:text-base","onUpdate:modelValue":e[1]||(e[1]=t=>a(l).bloco_id=t),onChange:k},[e[7]||(e[7]=o("option",{value:""},"Selecione...",-1)),(r(!0),n(g,null,v(f.value,t=>(r(),n("option",{key:t.id,value:t.id},w(t.nome),9,G))),128))],544),[[c,a(l).bloco_id]])]),o("div",null,[e[9]||(e[9]=o("label",{class:"font-medium text-sm md:text-base"},"Título da OS",-1)),u(o("input",{type:"text",class:"border p-2 rounded w-full text-sm md:text-base","onUpdate:modelValue":e[2]||(e[2]=t=>a(l).titulo=t)},null,512),[[C,a(l).titulo]])]),o("div",null,[e[10]||(e[10]=o("label",{class:"font-medium text-sm md:text-base"},"Descrição",-1)),u(o("textarea",{class:"border p-2 rounded w-full h-24 text-sm md:text-base","onUpdate:modelValue":e[3]||(e[3]=t=>a(l).descricao=t)},null,512),[[C,a(l).descricao]])]),o("div",null,[e[12]||(e[12]=o("label",{class:"font-medium text-sm md:text-base"},"Prioridade",-1)),u(o("select",{"onUpdate:modelValue":e[4]||(e[4]=t=>a(l).prioridade_id=t),class:"border p-2 rounded w-full text-sm md:text-base"},[e[11]||(e[11]=o("option",{value:""},"Selecione...",-1)),(r(!0),n(g,null,v(p.prioridades,t=>(r(),n("option",{key:t.id,value:t.id},w(t.nome),9,N))),128))],512),[[c,a(l).prioridade_id]])]),o("div",null,[e[13]||(e[13]=o("label",{class:"font-medium text-sm md:text-base"},"Tirar Foto",-1)),o("input",{type:"file",accept:"image/*",capture:"environment",multiple:"",name:"fotos[]",onChange:S,class:"w-full border rounded-lg p-2"},null,32),e[14]||(e[14]=o("label",{class:"font-medium text-sm md:text-base"},"Selecionar da Galeria",-1)),o("input",{type:"file",accept:"image/*",multiple:"",name:"fotos[]",onChange:S,class:"w-full border rounded-lg p-2"},null,32)]),e[15]||(e[15]=o("button",{class:"w-full bg-blue-600 text-white py-2 rounded hover:bg-blue-700 text-base md:text-lg"}," Criar OS ",-1))],32)]))}};export{J as default};
